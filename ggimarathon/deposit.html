<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>입금자를 찾습니다</title>

<style>
  body { font-family: Pretendard, sans-serif; padding: 20px; line-height: 1.5; color: #222; }
  h2 { font-size: 28px; font-weight: 700; margin-bottom: 15px; }
  table { width: 100%; border-collapse: collapse; font-size: 15px; margin-top: 10px; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
  th { background: #ececec; font-weight: 600; }
  #search {
    width: 300px; padding: 8px; font-size: 15px;
    margin-bottom: 15px; border: 1px solid #aaa; border-radius: 4px;
  }
  .alert { color: #c40000; font-weight: 600; }
  .notice {
    margin-top: 20px; padding: 15px;
    background: #fff7d4; border: 1px solid #ebcf79;
    border-radius: 6px; font-size: 14px;
  }
  .notice strong { color: #b20000; }
</style>
</head>

<body>

<h2>입금자를 찾습니다</h2>

<input type="text" id="search" placeholder="텍스트 입력하여 검색">

<table id="table">
  <thead></thead>
  <tbody></tbody>
</table>

<div class="notice">
  <strong>참가비 입금 시 생년월일 미기재 or 참가 미등록 상태</strong>인 경우,<br>
  위 내용을 확인하신 후 <strong>성함, 생년월일 + 입금 내역 사진</strong>을<br>
  카카오톡으로 첨부하여 전달 부탁드립니다.<br><br>
  예) 입금자를 찾습니다. 1번 김수원 250101
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
fetch("./data/deposit.xlsx")
  .then(res => res.arrayBuffer())
  .then(data => {
    const wb = XLSX.read(data, { type: "array" });
    const sheet = wb.Sheets[wb.SheetNames[0]];
    const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    const thead = document.querySelector("#table thead");
    const tbody = document.querySelector("#table tbody");

    // 헤더 생성
    let header = rows[0];
    let trHead = document.createElement("tr");
    header.forEach(col => {
      let th = document.createElement("th");
      th.textContent = col;
      trHead.appendChild(th);
    });
    thead.appendChild(trHead);

    // 데이터 생성
    rows.slice(1).forEach(row => {
      let tr = document.createElement("tr");
      row.forEach((cell, idx) => {
        let td = document.createElement("td");
        td.textContent = cell ?? "";
        // 마지막 컬럼에 내용 있으면 강조
        if (idx === row.length - 1 && td.textContent !== "") {
          td.classList.add("alert");
        }
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });

    // 검색
    document.querySelector("#search")
      .addEventListener("input", function () {
        let v = this.value.toLowerCase();
        tbody.querySelectorAll("tr").forEach(tr => {
          tr.style.display = tr.innerText.toLowerCase().includes(v) ? "" : "none";
        });
      });
  });
</script>

</body>
</html>
